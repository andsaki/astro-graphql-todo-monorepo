---
import Layout from '../layouts/Layout.astro';
import App from '../components/App.tsx';
import ErrorBoundaryWrapper from '../components/ErrorBoundary.tsx';
import { SortOrder } from '../generated/types';

const url = new URL(Astro.request.url);
const term = url.searchParams.get("term") || "";
const sortOrderParam = url.searchParams.get("sortOrder") || "DESC";

const getSortOrder = (param: string) => {
  if (param.toUpperCase() === 'ASC') {
    return SortOrder.Asc;
  }
  return SortOrder.Desc;
}

const initialSort = getSortOrder(sortOrderParam);
---

<Layout title="Todo App">
  <main>
    <ErrorBoundaryWrapper>
      <App client:load initialTerm={term} initialSort={initialSort} />
    </ErrorBoundaryWrapper>
  </main>
</Layout>